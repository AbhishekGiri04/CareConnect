<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CareMe Controller</title>
    <script src="https://www.gstatic.com/firebasejs/8.0.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.0.0/firebase-database.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/control_utils/control_utils.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/blazeface"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/handpose"></script>
    <script src="https://upload-widget.cloudinary.com/global/all.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Time and Weather Display -->
    <div class="time-weather-bar">
        <div class="time-display">
            <div id="currentTime">Loading...</div>
            <div id="currentDate">Loading...</div>
        </div>
        <div class="weather-display">
            <div id="weatherInfo">ğŸŒ¤ï¸ Loading weather...</div>
            <div id="locationInfo">ğŸ“ Getting location...</div>
        </div>
        <a href="/logout" class="logout-btn">Logout</a>
    </div>

    <center>
        <h1> CareMe </h1>
        <p style="margin: 10px 0;">Designed for Everyone - Voice, Touch, and Visual Controls</p>
    </center>

    <!-- Accessibility Controls -->
    <div class="accessibility-panel">
        <h3>ğŸŒŸ Accessibility Options</h3>
        <div class="accessibility-controls">
            <button id="highContrastBtn" onclick="toggleHighContrast()">ğŸ”† High Contrast</button>
            <button id="largeTextBtn" onclick="toggleLargeText()">ğŸ” Large Text</button>
            <button id="screenReaderBtn" onclick="toggleScreenReader()">ğŸ”Š Screen Reader</button>
            <button id="vibrationBtn" onclick="toggleVibration()">ğŸ“³ Vibration Alerts</button>
        </div>
    </div>

    <!-- Enhanced Voice Control Section -->
    <div class="voice-control">
        <h3>ğŸ¤ Advanced Voice Control</h3>
        <div class="voice-buttons">
            <button id="voiceBtn" onclick="startVoiceControl()">ğŸ¤ Voice Control</button>
            <button onclick="adjustVoiceSettings()">âš™ï¸ Voice Settings</button>
            <button onclick="startContinuousVoice()">ğŸ”„ Continuous Mode</button>
            <button onclick="stopContinuousVoice()">â¹ï¸ Stop Continuous</button>
        </div>
        <div class="voice-status">
            <p id="voiceStatus">Click microphone to start voice control</p>
            <p id="voiceCommand"></p>
        </div>
        <div class="voice-help">
            <h4>ğŸ“‹ Voice Commands Help</h4>
            <div class="command-examples">
                <div class="command-group">
                    <h5>ğŸ  Room Controls:</h5>
                    <p>â€¢ "Living room on"</p>
                    <p>â€¢ "Kitchen off"</p>
                    <p>â€¢ "Bedroom light on"</p>
                    <p>â€¢ "Bathroom light off"</p>
                </div>
                <div class="command-group">
                    <h5>ğŸš¨ Emergency Commands:</h5>
                    <p>â€¢ "Emergency"</p>
                    <p>â€¢ "All lights on"</p>
                    <p>â€¢ "Panic"</p>
                    <p>â€¢ "Help me"</p>
                </div>
                <div class="command-group">
                    <h5>ğŸ“Š Status Commands:</h5>
                    <p>â€¢ "Temperature"</p>
                    <p>â€¢ "What time"</p>
                    <p>â€¢ "Weather"</p>
                    <p>â€¢ "System status"</p>
                    <p>â€¢ "Motion"</p>
                    <p>â€¢ "Door status"</p>
                </div>
                <div class="command-group">
                    <h5>ğŸ”§ Control Commands:</h5>
                    <p>â€¢ "Security on"</p>
                    <p>â€¢ "Gesture control on"</p>
                    <p>â€¢ "High contrast"</p>
                    <p>â€¢ "Large text"</p>
                    <p>â€¢ "Screen reader"</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Enhanced Gesture Control Section -->
    <div class="gesture-control">
        <h3>ğŸ‘‹ Hand Gesture Control</h3>
        <div class="gesture-buttons">
            <button id="gestureBtn" onclick="toggleGestureControl()">ğŸ‘‹ Gesture Control</button>
            <button onclick="speakResponse('Show 1 to 4 fingers to control different lights')">â“ Help</button>
        </div>
        <p id="gestureStatus">Click to start gesture control</p>
        <div id="gestureInfo">Show 1-4 fingers to toggle LEDs</div>
        <div class="camera-container">
            <video id="videoElement" autoplay muted></video>
            <canvas id="canvasElement"></canvas>
        </div>
        <div class="gesture-help">
            <h4>âœ‹ Gesture Guide:</h4>
            <p>â€¢ 1ï¸âƒ£ One finger = Toggle LED 1 (Living Room)</p>
            <p>â€¢ 2ï¸âƒ£ Two fingers = Toggle LED 2 (Bedroom)</p>
            <p>â€¢ 3ï¸âƒ£ Three fingers = Toggle LED 3 (Kitchen)</p>
            <p>â€¢ 4ï¸âƒ£ Four fingers = Toggle LED 4 (Bathroom)</p>
        </div>
    </div>

    <!-- Large Button Controls for Wheelchair/Motor Impaired Users -->
    <div class="large-controls">
        <h3>ğŸ“± Large Touch Controls</h3>
        <button onclick="speakResponse('Large button controls are ready. Touch the buttons to control lights')">ğŸ”Š Audio Guide</button>
        <div class="large-buttons">
            <button class="large-btn" id="largeLed1" onclick="toggleLEDLarge('LED1')" aria-label="Toggle Living Room Light">
                <span class="btn-icon">ğŸ’¡</span>
                <span class="btn-text">Living Room</span>
                <span class="btn-status" id="largeLed1Status">OFF</span>
            </button>
            <button class="large-btn" id="largeLed2" onclick="toggleLEDLarge('LED2')" aria-label="Toggle Bedroom Light">
                <span class="btn-icon">ğŸ›Œ</span>
                <span class="btn-text">Bedroom</span>
                <span class="btn-status" id="largeLed2Status">OFF</span>
            </button>
            <button class="large-btn" id="largeLed3" onclick="toggleLEDLarge('LED3')" aria-label="Toggle Kitchen Light">
                <span class="btn-icon">ğŸ³</span>
                <span class="btn-text">Kitchen</span>
                <span class="btn-status" id="largeLed3Status">OFF</span>
            </button>
            <button class="large-btn" id="largeLed4" onclick="toggleLEDLarge('LED4')" aria-label="Toggle Bathroom Light">
                <span class="btn-icon">ğŸš¿</span>
                <span class="btn-text">Bathroom</span>
                <span class="btn-status" id="largeLed4Status">OFF</span>
            </button>
        </div>
        <button class="emergency-btn" onclick="emergencyAllLights(); speakResponse('Emergency mode activated! All lights have been turned on')" aria-label="Emergency - Turn on all lights">
            âš ï¸ EMERGENCY - ALL LIGHTS ON
        </button>
        <button class="voice-help-btn" onclick="speakResponse('Keyboard shortcuts: Press numbers 1 to 4 to control lights. Press Escape key to activate emergency mode')">
            âŒ¨ï¸ Keyboard Shortcuts Help
        </button>
    </div>

    <!-- Original Toggle Controls -->
    <div class="checkbox-wrapper">
        <div class="check">
            <input id="led1" type="checkbox" onchange="toggleLED('LED1', this.checked)" aria-label="Toggle Device 1">
            <label for="led1"></label>
        </div>
        <p id="statusLED1">Device 1 is OFF</p>
        
        <div class="check">
            <input id="led2" type="checkbox" onchange="toggleLED('LED2', this.checked)" aria-label="Toggle Device 2">
            <label for="led2"></label>
        </div>
        <p id="statusLED2">Device 2 is OFF</p>
        
        <div class="check">
            <input id="led3" type="checkbox" onchange="toggleLED('LED3', this.checked)" aria-label="Toggle Device 3">
            <label for="led3"></label>
        </div>
        <p id="statusLED3">Device 3 is OFF</p>
        
        <div class="check">
            <input id="led4" type="checkbox" onchange="toggleLED('LED4', this.checked)" aria-label="Toggle Device 4">
            <label for="led4"></label>
        </div>
        <p id="statusLED4">Device 4 is OFF</p>
    </div>

    <!-- Gas Leak Alert Section -->
    <div id="gasAlert" class="gas-alert hidden">
        <div class="alert-content">
            <h2>âš ï¸ GAS LEAK DETECTED!</h2>
            <p>Immediate action required!</p>
            <button onclick="acknowledgeAlert()">Acknowledge</button>
        </div>
    </div>

    <!-- Face Recognition Security Section -->
    <div class="face-security">
        <h3>ğŸ”’ Face Recognition Security</h3>
        <div class="face-controls">
            <button id="registerFaceBtn" onclick="startFaceRegistration()">ğŸ“· Register Face</button>
            <button id="securityBtn" onclick="toggleSecurity()">ğŸ” Start Security</button>
        </div>
        <p id="faceStatus">Click Register Face to set up security</p>
        <div class="security-camera">
            <video id="securityVideo" autoplay muted></video>
            <canvas id="securityCanvas"></canvas>
        </div>
        <div id="intruderAlert" class="intruder-alert hidden">
            <h4>âš ï¸ UNAUTHORIZED PERSON DETECTED!</h4>
            <p id="intruderTime"></p>
        </div>
    </div>

    <!-- Security Logs Section -->
    <div class="security-logs">
        <h3>ğŸ“„ Security Logs</h3>
        <div class="log-controls">
            <button onclick="downloadCSV()">ğŸ“¥ Download CSV</button>
            <button onclick="clearLogs()">ğŸ—‘ï¸ Clear Logs</button>
        </div>
        <div id="logsList"></div>
        <div id="intruderGallery"></div>
    </div>



    <!-- Emergency Contacts Section -->
    <div class="emergency-contacts">
        <h3>ğŸ†˜ Emergency Contacts</h3>
        <div class="contact-controls">
            <button onclick="showAddContactForm()">â• Add Contact</button>
            <button onclick="testEmergencyAlert()">ğŸš¨ Test Alert</button>
        </div>
        <div id="contactsList"></div>
        
        <!-- Add Contact Form -->
        <div id="addContactForm" class="contact-form hidden">
            <h4>Add Emergency Contact</h4>
            <input type="text" id="contactName" placeholder="Full Name" required>
            <input type="tel" id="contactPhone" placeholder="Phone Number" required>
            <input type="email" id="contactEmail" placeholder="Email Address" required>
            <div class="form-buttons">
                <button onclick="saveEmergencyContact()">âœ“ Save Contact</button>
                <button onclick="hideAddContactForm()">âŒ Cancel</button>
            </div>
        </div>
    </div>

    <!-- Safety Status Section -->
    <div class="safety-status">
        <h3>ğŸ›¡ï¸ Safety Status</h3>
        <div class="status-item">
            <span class="status-label">Gas Leak:</span>
            <span id="gasStatus" class="status-safe">SAFE</span>
        </div>
        <div class="status-item">
            <span class="status-label">Security:</span>
            <span id="securityStatus" class="status-safe">INACTIVE</span>
        </div>
        <div class="status-item">
            <span class="status-label">Temperature:</span>
            <span id="tempStatus" class="status-safe">NORMAL</span>
        </div>
        <div class="status-item">
            <span class="status-label">Motion:</span>
            <span id="motionStatus" class="status-safe">NONE</span>
        </div>
        <div class="status-item">
            <span class="status-label">Door Status:</span>
            <span id="doorStatus" class="status-safe">SECURE</span>
        </div>
    </div>

    <!-- PIR Motion Detection Section -->
    <div class="motion-detection">
        <h3>ğŸš¶ Motion Detection</h3>
        <div id="pirDetections"></div>
        <button onclick="clearMotionHistory()">ğŸ—‘ï¸ Clear History</button>
    </div>

    <!-- Medical Emergency Section -->
    <div class="medical-emergency">
        <h3>ğŸ¥ Medical Emergency</h3>
        <div class="medical-controls">
            <button class="panic-btn" onclick="triggerPanicAlert()">ğŸš¨ PANIC BUTTON</button>
            <button onclick="callEmergencyServices()">ğŸ“ Call 911</button>
            <button onclick="sendMedicalAlert()">ğŸ’Š Medical Alert</button>
        </div>
        <div class="medical-info">
            <h4>Quick Medical Info</h4>
            <div id="medicalProfile">No medical profile set</div>
            <button onclick="setMedicalProfile()">âš•ï¸ Set Medical Info</button>
        </div>
    </div>

    <!-- Medication Reminders -->
    <div class="medication-reminders">
        <h3>ğŸ’Š Medication Reminders</h3>
        <div id="medicationList"></div>
        <button onclick="addMedication()">â• Add Medication</button>
    </div>

    <!-- Communication Board Section -->
    <div class="communication-board">
        <h3>ğŸ’¬ Communication Board</h3>
        
        <!-- Braille Drawing for Blind Users -->
        <div class="braille-section">
            <h4>âš™ï¸ Braille Drawing (For Blind Users)</h4>
            <div class="braille-controls">
                <button onclick="startBrailleDrawing()">âœï¸ Start Drawing</button>
                <button onclick="clearBrailleCanvas()">ğŸ—‘ï¸ Clear</button>
                <button onclick="translateBraille()">ğŸ”„ Translate to English</button>
            </div>
            <canvas id="brailleCanvas" width="600" height="400"></canvas>
            <div id="brailleInstructions">Draw Braille patterns with your finger or mouse. Each dot pattern will be recognized.</div>
        </div>

        <!-- Sign Language Recognition for Deaf Users -->
        <div class="sign-language-section">
            <h4>ğŸ¤Ÿ Sign Language Recognition (For Deaf Users)</h4>
            <div class="sign-controls">
                <button id="signBtn" onclick="toggleSignLanguage()">ğŸ“¹ Start Sign Recognition</button>
                <button onclick="clearSignHistory()">ğŸ—‘ï¸ Clear History</button>
            </div>
            <div class="sign-camera">
                <video id="signVideo" autoplay muted></video>
                <canvas id="signCanvas"></canvas>
            </div>
            <div id="signStatus">Click Start to begin sign language recognition</div>
            <div id="currentSign">Detected: None</div>
        </div>

        <!-- Chat Box for Translated Messages -->
        <div class="chat-section">
            <h4>ğŸ’¬ Message History</h4>
            <div id="chatBox"></div>
            <div class="chat-controls">
                <input type="text" id="manualMessage" placeholder="Type message manually..." aria-label="Manual message input">
                <button onclick="addManualMessage()">â¤ Send</button>
                <button onclick="clearChatHistory()">ğŸ—‘ï¸ Clear Chat</button>
                <button onclick="downloadChatHistory()">ğŸ“¥ Download</button>
            </div>
            <div class="quick-phrases">
                <h5>Quick Phrases</h5>
                <button onclick="addQuickPhrase('I need help')">Help</button>
                <button onclick="addQuickPhrase('Call family')">Call Family</button>
                <button onclick="addQuickPhrase('I am okay')">I'm OK</button>
                <button onclick="addQuickPhrase('Emergency')">Emergency</button>
            </div>
        </div>
    </div>

    <!-- Medical Profile Modal -->
    <div id="medicalModal" class="modal hidden">
        <div class="modal-content">
            <h3>âš•ï¸ Medical Profile</h3>
            <input type="text" id="medicalConditions" placeholder="Medical conditions (diabetes, heart disease, etc.)">
            <input type="text" id="allergies" placeholder="Allergies">
            <input type="text" id="medications" placeholder="Current medications">
            <input type="text" id="emergencyContact" placeholder="Emergency contact">
            <input type="text" id="bloodType" placeholder="Blood type">
            <div class="modal-buttons">
                <button onclick="saveMedicalProfile()">âœ“ Save</button>
                <button onclick="closeMedicalModal()">âŒ Cancel</button>
            </div>
        </div>
    </div>

    <!-- Medication Modal -->
    <div id="medicationModal" class="modal hidden">
        <div class="modal-content">
            <h3>ğŸ’Š Add Medication</h3>
            <input type="text" id="medName" placeholder="Medication name">
            <input type="time" id="medTime" placeholder="Time">
            <input type="text" id="medDosage" placeholder="Dosage">
            <select id="medFrequency">
                <option value="daily">Daily</option>
                <option value="twice">Twice daily</option>
                <option value="weekly">Weekly</option>
            </select>
            <div class="modal-buttons">
                <button onclick="saveMedication()">âœ“ Save</button>
                <button onclick="closeMedicationModal()">âŒ Cancel</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>